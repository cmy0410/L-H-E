1. Combine normalization of demands and calculation of inverse demands into a single step for efficiency. 
2. Use masked_fill_ instead of direct indexing for setting negative values. 
3. Prioritize vectorized operations and avoid unnecessary function calls. 
4. Handle negative, NaN, and Inf values appropriately. 
5. Normalize demands based on sum of demands rather than maximum demand for improved scaling.
